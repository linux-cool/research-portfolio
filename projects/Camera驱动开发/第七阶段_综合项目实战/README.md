# 第七阶段：综合项目实战

## 阶段概述
本阶段目标是整合所有学习内容，完成端到端的摄像头项目，从硬件选型到驱动开发到应用程序的完整实践。

**预计时间**: 4-6 周

## 学习目标
- [ ] 完成一个完整的摄像头项目
- [ ] 从驱动层到应用层全栈掌握
- [ ] 解决实际工程问题
- [ ] 形成可复用的项目模板

## 项目选型

### 项目1: USB 摄像头采集系统 (入门级)

#### 项目目标
```
USB 摄像头 → V4L2 采集 → FFmpeg 编码 → 本地录制/RTMP 推流
```

#### 硬件需求
- 任意 USB UVC 摄像头
- x86 PC 或 ARM 开发板

#### 技术栈
| 层次 | 技术 |
|------|------|
| 应用层 | FFmpeg CLI / 自写采集程序 |
| 接口层 | V4L2 用户空间 API |
| 驱动层 | 内核 UVC 驱动 (uvcvideo) |

#### 交付物
- [ ] V4L2 采集程序 (C语言)
- [ ] FFmpeg 推流脚本
- [ ] 性能测试报告

---

### 项目2: MIPI 摄像头采集系统 (进阶级)

#### 项目目标
```
MIPI 传感器 → CSI-2 接收 → ISP 处理 → V4L2 采集 → 编码输出
```

#### 硬件需求
- 树莓派 4/5 + 官方摄像头模块
- 或 RK3568/RK3588 + MIPI 传感器

#### 技术栈
| 层次 | 技术 |
|------|------|
| 应用层 | GStreamer / 自写程序 |
| 接口层 | V4L2 + Media Controller |
| 驱动层 | 传感器驱动 + CSI 驱动 + ISP 驱动 |

#### 交付物
- [ ] Media Controller 管道配置脚本
- [ ] V4L2 采集程序
- [ ] ISP 参数调优文档
- [ ] 图像质量评估报告

---

### 项目3: 传感器驱动移植 (专业级)

#### 项目目标
```
选定传感器 → 编写驱动 → 设备树配置 → 内核集成 → 测试验证
```

#### 推荐传感器
| 传感器 | 分辨率 | 接口 | 难度 |
|--------|--------|------|------|
| OV2640 | 2MP | DVP/MIPI | ⭐⭐ |
| GC2053 | 2MP | MIPI | ⭐⭐⭐ |
| IMX219 | 8MP | MIPI | ⭐⭐⭐ |
| OV5640 | 5MP | MIPI | ⭐⭐⭐⭐ |
| IMX477 | 12MP | MIPI | ⭐⭐⭐⭐⭐ |

#### 交付物
- [ ] 完整传感器驱动代码
- [ ] 设备树配置文件
- [ ] 驱动移植文档
- [ ] 测试用例和结果

---

## 项目实施流程

### 阶段一: 需求分析 (第1周)
```
├── 确定项目目标
├── 选定硬件平台
├── 选定传感器型号
├── 获取数据手册
└── 制定技术方案
```

### 阶段二: 驱动开发 (第2-3周)
```
├── 搭建开发环境
├── 编写/移植驱动
├── 配置设备树
├── 编译内核/模块
└── 基础功能验证
```

### 阶段三: 应用开发 (第4周)
```
├── V4L2 采集程序
├── 编码推流功能
├── 用户界面 (可选)
└── 性能优化
```

### 阶段四: 测试与文档 (第5-6周)
```
├── 功能测试
├── 性能测试
├── 稳定性测试
├── 文档编写
└── 项目总结
```

## 评估指标

### 功能指标
| 指标 | 要求 |
|------|------|
| 分辨率 | 支持多种分辨率切换 |
| 帧率 | 达到传感器标称帧率 |
| 格式 | 支持 YUV/RAW 输出 |
| 控制 | 曝光/增益可调 |

### 性能指标
| 指标 | 目标 |
|------|------|
| CPU 占用 | 软编码 < 50%，硬编码 < 10% |
| 延迟 | 采集到编码 < 100ms |
| 功耗 | 满足目标平台要求 |

### 稳定性指标
| 指标 | 要求 |
|------|------|
| 长时间运行 | 24小时无崩溃 |
| 压力测试 | 多次开关流无泄漏 |
| 异常处理 | 拔插/断电可恢复 |

## 参考资源

### 开源项目
- libcamera: https://libcamera.org/
- v4l-utils: https://git.linuxtv.org/v4l-utils.git
- GStreamer: https://gstreamer.freedesktop.org/

### 开发板资源
- 树莓派: https://www.raspberrypi.com/documentation/
- Rockchip: https://opensource.rock-chips.com/
- 全志: https://linux-sunxi.org/

## 阶段验收标准
- [ ] 完成选定项目的所有功能
- [ ] 通过全部测试用例
- [ ] 完成项目文档
- [ ] 代码可复用/可维护

## 文件结构
```
第七阶段_综合项目实战/
├── README.md
├── project1_usb_camera/    # USB摄像头项目
│   ├── src/
│   ├── scripts/
│   └── docs/
├── project2_mipi_camera/   # MIPI摄像头项目
│   ├── src/
│   ├── dts/
│   └── docs/
├── project3_sensor_driver/ # 传感器驱动项目
│   ├── driver/
│   ├── dts/
│   └── docs/
└── templates/              # 项目模板
```

---

## 🎉 学习路线完成

恭喜！完成本阶段后，您将具备：
- FFmpeg 多媒体处理能力
- V4L2 用户/内核编程能力
- Camera 驱动开发能力
- 完整的摄像头项目经验

**返回**: [项目首页](../README.md)

